<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KoquiFI Lottery</title>
    <meta property="fc:frame" content="vNext">
    <meta property="fc:frame:image" content="https://your-domain.com/api/frame/image">
    <meta property="fc:frame:button:1" content="üé´ Comprar Ticket">
    <meta property="fc:frame:button:2" content="üìä Estado">
    <meta property="fc:frame:button:3" content="üèÜ Resultados">
    <meta property="fc:frame:button:4" content="‚ÑπÔ∏è Info">
    <meta property="fc:frame:post_url" content="https://your-domain.com/api/frame">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px 20px;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 800;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 8px 16px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: #ffffff;
        }

        .user-fid {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .login-btn {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
        }

        .login-icon {
            font-size: 16px;
        }

        .header-stats {
            display: flex;
            gap: 16px;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px 16px;
            text-align: center;
            min-width: 80px;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
        }

        /* Main Content */
        .main-container {
            margin-top: 80px;
            padding: 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #ffffff, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto 32px;
            line-height: 1.6;
        }

        /* Countdown Section */
        .countdown-section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 40px;
            backdrop-filter: blur(20px);
        }

        .countdown-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            text-align: center;
        }

        .countdown-display {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .countdown-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
        }

        .countdown-number {
            font-size: 36px;
            font-weight: 800;
            color: #ff6b6b;
            margin-bottom: 8px;
        }

        .countdown-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Lottery Cards */
        .lottery-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .lottery-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .lottery-card:hover {
            transform: translateY(-4px);
            border-color: rgba(255, 107, 107, 0.3);
            box-shadow: 0 20px 40px rgba(255, 107, 107, 0.1);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .card-value {
            font-size: 24px;
            font-weight: 800;
            color: #4ecdc4;
            margin-bottom: 8px;
        }

        .card-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
        }

        /* Action Buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 40px;
        }

        .action-btn {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border: none;
            border-radius: 16px;
            padding: 20px 24px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .action-btn:hover::before {
            left: 100%;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
        }

        .action-btn:active {
            transform: translateY(0);
        }

        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px 20px;
        }

        .nav-content {
            display: flex;
            justify-content: space-around;
            max-width: 1200px;
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 60px;
        }

        .nav-item.active {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            margin: 5% auto;
            padding: 32px;
            width: 90%;
            max-width: 600px;
            position: relative;
            backdrop-filter: blur(20px);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
        }

        .close {
            color: rgba(255, 255, 255, 0.6);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #ff6b6b;
        }

        /* Number Grid */
        .number-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 12px;
            margin: 24px 0;
        }

        .number-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .number-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #4ecdc4;
            transform: translateY(-2px);
        }

        .number-btn.selected {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-color: transparent;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
        }

        /* Loading and Messages */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ff6b6b;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .success-message {
            background: rgba(76, 205, 196, 0.1);
            border: 1px solid #4ecdc4;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: #4ecdc4;
            font-weight: 500;
        }

        .error-message {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            color: #ff6b6b;
            font-weight: 500;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 36px;
            }
            
            .countdown-display {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .lottery-cards {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .header-stats {
                gap: 8px;
            }
            
            .stat-box {
                min-width: 60px;
                padding: 8px 12px;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 16px;
            }
            
            .countdown-display {
                grid-template-columns: 1fr;
            }
            
            .number-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üé∞</div>
                <div class="logo-text">KoquiFI Lottery</div>
            </div>
            <div class="header-actions">
                <div id="userInfo" class="user-info" style="display: none;">
                    <div class="user-avatar" id="userAvatar">üë§</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Usuario</div>
                        <div class="user-fid" id="userFid">FID: --</div>
                    </div>
                </div>
                <button id="loginBtn" class="login-btn" onclick="showLoginModal()">
                    <span class="login-icon">üîó</span>
                    Iniciar Sesi√≥n
                </button>
                <div class="header-stats" id="headerStats" style="display: none;">
                    <div class="stat-box">
                        <div class="stat-label">Balance</div>
                        <div class="stat-value" id="userBalance">-- KOKI</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Tickets</div>
                        <div class="stat-value" id="userTickets">--</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Hero Section -->
        <section class="hero-section fade-in">
            <h1 class="hero-title">KoquiFI Lottery</h1>
            <p class="hero-subtitle">Descubre, compra y gana con tickets √∫nicos en la blockchain. Tu suerte te espera cada lunes.</p>
        </section>

        <!-- Countdown Section -->
        <section class="countdown-section fade-in">
            <h2 class="countdown-title">‚è≥ Pr√≥ximo Sorteo</h2>
            <div class="countdown-display">
                <div class="countdown-item">
                    <div class="countdown-number" id="days">--</div>
                    <div class="countdown-label">D√≠as</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="hours">--</div>
                    <div class="countdown-label">Horas</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="minutes">--</div>
                    <div class="countdown-label">Minutos</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="seconds">--</div>
                    <div class="countdown-label">Segundos</div>
                </div>
            </div>
        </section>

        <!-- Lottery Stats Cards -->
        <section class="lottery-cards fade-in">
            <div class="lottery-card">
                <div class="card-icon">üé´</div>
                <div class="card-title">Tickets Vendidos</div>
                <div class="card-value" id="ticketsSold">--</div>
                <div class="card-label">Esta semana</div>
            </div>
            <div class="lottery-card">
                <div class="card-icon">üí∞</div>
                <div class="card-title">Premio Total</div>
                <div class="card-value" id="totalPrize">-- KOKI</div>
                <div class="card-label">En el pozo</div>
            </div>
            <div class="lottery-card">
                <div class="card-icon">üèÜ</div>
                <div class="card-title">Precio Ticket</div>
                <div class="card-value">10 KOKI</div>
                <div class="card-label">Por n√∫mero</div>
            </div>
        </section>

        <!-- Action Buttons -->
        <section class="action-buttons fade-in">
            <button class="action-btn" onclick="openBuyModal()">
                üé´ Comprar Ticket
            </button>
            <button class="action-btn secondary" onclick="showStatus()">
                üìä Estado
            </button>
            <button class="action-btn secondary" onclick="showResults()">
                üèÜ Resultados
            </button>
            <button class="action-btn secondary" onclick="showInfo()">
                ‚ÑπÔ∏è Informaci√≥n
            </button>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-content">
            <div class="nav-item active" onclick="showHome()">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">Inicio</div>
            </div>
            <div class="nav-item" onclick="showCollection()">
                <div class="nav-icon">üé´</div>
                <div class="nav-label">Mis Tickets</div>
            </div>
            <div class="nav-item" onclick="showResults()">
                <div class="nav-icon">üèÜ</div>
                <div class="nav-label">Resultados</div>
            </div>
            <div class="nav-item" onclick="showProfile()">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">Perfil</div>
            </div>
        </div>
    </nav>

    <!-- Modal para comprar tickets -->
    <div id="buyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üé´ Comprar Ticket</h2>
                <span class="close" onclick="closeBuyModal()">&times;</span>
            </div>
            <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 24px;">Selecciona un n√∫mero del 1 al 50:</p>
            <div class="number-grid" id="numberGrid"></div>
            <div id="selectedNumber" style="margin: 24px 0; font-weight: 600; font-size: 18px; color: #4ecdc4;"></div>
            <button class="action-btn" onclick="buyTicket()" id="buyBtn" disabled style="width: 100%;">
                Comprar Ticket (10 KOKI)
            </button>
            <div id="buyMessage"></div>
        </div>
    </div>

    <!-- Modal para mostrar estado -->
    <div id="statusModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìä Estado de la Loter√≠a</h2>
                <span class="close" onclick="closeStatusModal()">&times;</span>
            </div>
            <div id="statusContent"></div>
        </div>
    </div>

    <!-- Modal para mostrar resultados -->
    <div id="resultsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üèÜ Resultados</h2>
                <span class="close" onclick="closeResultsModal()">&times;</span>
            </div>
            <div id="resultsContent"></div>
        </div>
    </div>

    <!-- Modal para mostrar informaci√≥n -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚ÑπÔ∏è Informaci√≥n del Proyecto</h2>
                <span class="close" onclick="closeInfoModal()">&times;</span>
            </div>
            <div id="infoContent">
                <div style="margin-bottom: 24px;">
                    <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 16px; color: #4ecdc4;">üé∞ KoquiFI Lottery</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6;">Una loter√≠a descentralizada en Base Network donde puedes comprar tickets con tokens KOKI y ganar premios cada semana.</p>
                </div>
                
                <div style="margin-bottom: 24px;">
                    <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: #ff6b6b;">¬øC√≥mo funciona?</h4>
                    <ul style="color: rgba(255, 255, 255, 0.8); line-height: 1.8; padding-left: 20px;">
                        <li>Compra tickets con tokens KOKI</li>
                        <li>Selecciona un n√∫mero del 1 al 50</li>
                        <li>Los sorteos son cada lunes a las 00:00 UTC</li>
                        <li>Se seleccionan 5 n√∫meros ganadores</li>
                        <li>Los premios se distribuyen entre los ganadores</li>
                    </ul>
                </div>
                
                <div style="margin-bottom: 24px;">
                    <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: #ff6b6b;">üéØ Reglas</h4>
                    <ul style="color: rgba(255, 255, 255, 0.8); line-height: 1.8; padding-left: 20px;">
                        <li>Precio por ticket: 10 KOKI</li>
                        <li>N√∫meros disponibles: 1-50</li>
                        <li>N√∫meros ganadores: 5</li>
                        <li>Frecuencia: Semanal (lunes)</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px;">
                    <p style="margin-bottom: 8px;"><strong style="color: #4ecdc4;">üîó Red:</strong> <span style="color: rgba(255, 255, 255, 0.8);">Base Network</span></p>
                    <p><strong style="color: #4ecdc4;">ü™ô Token:</strong> <span style="color: rgba(255, 255, 255, 0.8);">KOKI</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de inicio de sesi√≥n -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="loginModalTitle">üîó Iniciar Sesi√≥n</h2>
                <span class="close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div id="loginContent">
                <!-- Formulario de Login -->
                <div id="loginForm" style="display: block;">
                    <div style="text-align: center; padding: 20px 0;">
                        <div style="font-size: 64px; margin-bottom: 24px;">üé∞</div>
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: #4ecdc4;">¬°Bienvenido de vuelta!</h3>
                        <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; margin-bottom: 32px;">
                            Inicia sesi√≥n para continuar jugando y ganando premios.
                        </p>
                        
                        <form id="loginFormElement" onsubmit="handleLogin(event)">
                            <div style="margin-bottom: 20px;">
                                <input type="email" id="loginEmail" placeholder="Email" required 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 24px;">
                                <input type="password" id="loginPassword" placeholder="Contrase√±a" required 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <button type="submit" class="action-btn" style="width: 100%; margin-bottom: 16px;">
                                <span style="font-size: 20px; margin-right: 12px;">üîë</span>
                                Iniciar Sesi√≥n
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 12px;">
                                ¬øNo tienes cuenta?
                            </p>
                            <button class="action-btn secondary" onclick="showRegisterForm()" style="width: 100%;">
                                <span style="font-size: 16px; margin-right: 8px;">üìù</span>
                                Crear Cuenta
                            </button>
                        </div>
                        
                        <div style="margin-top: 24px; padding: 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px;">
                            <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 8px; color: #ff6b6b;">üë• Usuarios de Demo:</h4>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">
                                <div>demo1@kokifi.com / demo123</div>
                                <div>demo2@kokifi.com / demo123</div>
                                <div>demo3@kokifi.com / demo123</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Formulario de Registro -->
                <div id="registerForm" style="display: none;">
                    <div style="text-align: center; padding: 20px 0;">
                        <div style="font-size: 64px; margin-bottom: 24px;">üéâ</div>
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: #4ecdc4;">¬°√önete a KoquiFI Lottery!</h3>
                        <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; margin-bottom: 32px;">
                            Crea tu cuenta y recibe 1000 KOKI de bienvenida.
                        </p>
                        
                        <form id="registerFormElement" onsubmit="handleRegister(event)">
                            <div style="margin-bottom: 16px;">
                                <input type="text" id="registerUsername" placeholder="Nombre de usuario" required 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 16px;">
                                <input type="email" id="registerEmail" placeholder="Email" required 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 16px;">
                                <input type="password" id="registerPassword" placeholder="Contrase√±a (m√≠n. 6 caracteres)" required 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 24px;">
                                <input type="text" id="registerAvatar" placeholder="Avatar (emoji)" 
                                       style="width: 100%; padding: 16px; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
                            </div>
                            <button type="submit" class="action-btn" style="width: 100%; margin-bottom: 16px;">
                                <span style="font-size: 20px; margin-right: 12px;">üöÄ</span>
                                Crear Cuenta
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 12px;">
                                ¬øYa tienes cuenta?
                            </p>
                            <button class="action-btn secondary" onclick="showLoginForm()" style="width: 100%;">
                                <span style="font-size: 16px; margin-right: 8px;">üîë</span>
                                Iniciar Sesi√≥n
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="loginMessage" style="margin-top: 16px;"></div>
            </div>
        </div>
    </div>

    <script>
        let selectedNumber = null;
        let countdownInterval = null;
        let currentSection = 'home';
        let userSession = null;

        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeNumberGrid();
            startCountdown();
            loadLotteryInfo();
            checkUserSession();
            addFadeInAnimations();
        });

        // Verificar sesi√≥n del usuario
        function checkUserSession() {
            const savedSession = localStorage.getItem('userSession');
            if (savedSession) {
                try {
                    userSession = JSON.parse(savedSession);
                    showUserLoggedIn();
                } catch (error) {
                    console.error('Error parsing saved session:', error);
                    localStorage.removeItem('userSession');
                }
            } else {
                showUserLoggedOut();
            }
        }

        // Mostrar usuario logueado
        function showUserLoggedIn() {
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('headerStats').style.display = 'flex';
            
            // Actualizar informaci√≥n del usuario
            document.getElementById('userName').textContent = userSession.username || 'Usuario';
            document.getElementById('userFid').textContent = `ID: ${userSession.id}`;
            document.getElementById('userAvatar').textContent = userSession.avatar || 'üë§';
            
            // Cargar datos del usuario
            loadUserInfo();
        }

        // Mostrar usuario no logueado
        function showUserLoggedOut() {
            document.getElementById('loginBtn').style.display = 'flex';
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('headerStats').style.display = 'none';
        }

        // Mostrar modal de login
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'block';
            showLoginForm();
        }

        // Cerrar modal de login
        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            clearLoginMessages();
        }

        // Mostrar formulario de login
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginModalTitle').textContent = 'üîó Iniciar Sesi√≥n';
            clearLoginMessages();
        }

        // Mostrar formulario de registro
        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('loginModalTitle').textContent = 'üìù Crear Cuenta';
            clearLoginMessages();
        }

        // Limpiar mensajes
        function clearLoginMessages() {
            document.getElementById('loginMessage').innerHTML = '';
        }

        // Manejar login
        async function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            submitBtn.innerHTML = '<span class="loading"></span> Iniciando sesi√≥n...';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    userSession = result.data.user;
                    localStorage.setItem('userSession', JSON.stringify(userSession));
                    
                    showUserLoggedIn();
                    closeLoginModal();
                    showWelcomeMessage();
                } else {
                    showLoginMessage(result.error, 'error');
                }
            } catch (error) {
                showLoginMessage('Error de conexi√≥n', 'error');
            }
            
            submitBtn.innerHTML = '<span style="font-size: 20px; margin-right: 12px;">üîë</span>Iniciar Sesi√≥n';
            submitBtn.disabled = false;
        }

        // Manejar registro
        async function handleRegister(event) {
            event.preventDefault();
            
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const avatar = document.getElementById('registerAvatar').value || 'üé∞';
            const submitBtn = event.target.querySelector('button[type="submit"]');
            
            submitBtn.innerHTML = '<span class="loading"></span> Creando cuenta...';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, email, password, avatar })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    userSession = result.data.user;
                    localStorage.setItem('userSession', JSON.stringify(userSession));
                    
                    showUserLoggedIn();
                    closeLoginModal();
                    showWelcomeMessage();
                } else {
                    showLoginMessage(result.error, 'error');
                }
            } catch (error) {
                showLoginMessage('Error de conexi√≥n', 'error');
            }
            
            submitBtn.innerHTML = '<span style="font-size: 20px; margin-right: 12px;">üöÄ</span>Crear Cuenta';
            submitBtn.disabled = false;
        }

        // Mostrar mensaje en el modal
        function showLoginMessage(message, type) {
            const messageDiv = document.getElementById('loginMessage');
            const className = type === 'error' ? 'error-message' : 'success-message';
            messageDiv.innerHTML = `<div class="${className}">${message}</div>`;
        }

        // Mostrar mensaje de bienvenida
        function showWelcomeMessage() {
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            content.innerHTML = `
                <div style="text-align: center; padding: 20px 0;">
                    <div style="font-size: 64px; margin-bottom: 24px;">üéâ</div>
                    <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: #4ecdc4;">¬°Bienvenido a KoquiFI Lottery!</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; margin-bottom: 24px;">
                        Tu cuenta de Farcaster ha sido conectada exitosamente.
                    </p>
                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px; margin-bottom: 24px;">
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: #ff6b6b;">${userSession.username}</div>
                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 14px;">FID: ${userSession.fid}</div>
                    </div>
                    <p style="color: rgba(255, 255, 255, 0.8);">
                        ¬°Ahora puedes comprar tickets y participar en los sorteos semanales!
                    </p>
                </div>
            `;
            modal.style.display = 'block';
            
            // Cerrar autom√°ticamente despu√©s de 3 segundos
            setTimeout(() => {
                modal.style.display = 'none';
            }, 3000);
        }

        // Cerrar sesi√≥n
        function logout() {
            userSession = null;
            localStorage.removeItem('userSession');
            showUserLoggedOut();
            
            // Mostrar mensaje de despedida
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            content.innerHTML = `
                <div style="text-align: center; padding: 20px 0;">
                    <div style="font-size: 64px; margin-bottom: 24px;">üëã</div>
                    <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: #4ecdc4;">¬°Hasta luego!</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6;">
                        Tu sesi√≥n ha sido cerrada. ¬°Vuelve pronto para seguir jugando!
                    </p>
                </div>
            `;
            modal.style.display = 'block';
            
            setTimeout(() => {
                modal.style.display = 'none';
            }, 2000);
        }

        // Agregar animaciones de entrada
        function addFadeInAnimations() {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((element, index) => {
                element.style.animationDelay = `${index * 0.1}s`;
            });
        }

        // Cargar informaci√≥n del usuario
        async function loadUserInfo() {
            if (!userSession) return;
            
            try {
                const response = await fetch(`/api/auth/user/${userSession.id}`);
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        const user = result.data.user;
                        document.getElementById('userBalance').textContent = `${user.balance || '0'} KOKI`;
                        document.getElementById('userTickets').textContent = user.ticketsCount || '0';
                        
                        // Actualizar sesi√≥n local con datos actualizados
                        userSession = user;
                        localStorage.setItem('userSession', JSON.stringify(userSession));
                    }
                } else {
                    // Usar datos de la sesi√≥n local
                    document.getElementById('userBalance').textContent = `${userSession.balance || '0'} KOKI`;
                    document.getElementById('userTickets').textContent = userSession.ticketsCount || '0';
                }
            } catch (error) {
                console.error('Error loading user info:', error);
                // Usar datos de la sesi√≥n local
                document.getElementById('userBalance').textContent = `${userSession.balance || '0'} KOKI`;
                document.getElementById('userTickets').textContent = userSession.ticketsCount || '0';
            }
        }

        // Navegaci√≥n
        function showHome() {
            setActiveNav(0);
            currentSection = 'home';
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showCollection() {
            setActiveNav(1);
            currentSection = 'collection';
            showUserTickets();
        }

        function showResults() {
            setActiveNav(2);
            currentSection = 'results';
            showResultsModal();
        }

        function showProfile() {
            setActiveNav(3);
            currentSection = 'profile';
            showUserProfile();
        }

        function setActiveNav(index) {
            document.querySelectorAll('.nav-item').forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // Mostrar tickets del usuario
        function showUserTickets() {
            if (!userSession) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            content.innerHTML = `
                <div style="text-align: center;">
                    <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 24px; color: #4ecdc4;">üé´ Mis Tickets</h3>
                    <div style="display: grid; gap: 16px;">
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px;">
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">Ticket #1</div>
                            <div style="color: rgba(255, 255, 255, 0.7);">N√∫mero: 25 | Loter√≠a: #1</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px;">
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">Ticket #2</div>
                            <div style="color: rgba(255, 255, 255, 0.7);">N√∫mero: 42 | Loter√≠a: #1</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px;">
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">Ticket #3</div>
                            <div style="color: rgba(255, 255, 255, 0.7);">N√∫mero: 7 | Loter√≠a: #1</div>
                        </div>
                    </div>
                </div>
            `;
            modal.style.display = 'block';
        }

        // Mostrar perfil del usuario
        function showUserProfile() {
            if (!userSession) {
                showLoginModal();
                return;
            }
            
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            content.innerHTML = `
                <div style="text-align: center;">
                    <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 24px; color: #4ecdc4;">üë§ Mi Perfil</h3>
                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 24px; margin-bottom: 20px;">
                        <div style="font-size: 48px; margin-bottom: 16px;">${userSession.avatar || 'üé∞'}</div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">${userSession.username}</div>
                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 14px;">FID: ${userSession.fid}</div>
                        <div style="color: rgba(255, 255, 255, 0.6); font-size: 12px; margin-top: 4px;">${userSession.address}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #4ecdc4; margin-bottom: 4px;">3</div>
                            <div style="color: rgba(255, 255, 255, 0.7); font-size: 12px;">Tickets Comprados</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 16px; text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #ff6b6b; margin-bottom: 4px;">0</div>
                            <div style="color: rgba(255, 255, 255, 0.7); font-size: 12px;">Premios Ganados</div>
                        </div>
                    </div>
                    <button class="action-btn secondary" onclick="logout()" style="width: 100%;">
                        <span style="font-size: 16px; margin-right: 8px;">üö™</span>
                        Cerrar Sesi√≥n
                    </button>
                </div>
            `;
            modal.style.display = 'block';
        }

        // Crear grid de n√∫meros
        function initializeNumberGrid() {
            const grid = document.getElementById('numberGrid');
            for (let i = 1; i <= 50; i++) {
                const btn = document.createElement('button');
                btn.className = 'number-btn';
                btn.textContent = i;
                btn.onclick = () => selectNumber(i);
                grid.appendChild(btn);
            }
        }

        // Seleccionar n√∫mero
        function selectNumber(number) {
            selectedNumber = number;
            
            // Actualizar UI
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            document.getElementById('selectedNumber').textContent = `N√∫mero seleccionado: ${number}`;
            document.getElementById('buyBtn').disabled = false;
        }

        // Abrir modal de compra
        function openBuyModal() {
            if (!userSession) {
                // Si no est√° logueado, mostrar modal de login
                showLoginModal();
                return;
            }
            document.getElementById('buyModal').style.display = 'block';
        }

        // Cerrar modal de compra
        function closeBuyModal() {
            document.getElementById('buyModal').style.display = 'none';
            selectedNumber = null;
            document.getElementById('selectedNumber').textContent = '';
            document.getElementById('buyBtn').disabled = true;
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
        }

        // Comprar ticket
        async function buyTicket() {
            if (!selectedNumber || !userSession) return;
            
            const buyBtn = document.getElementById('buyBtn');
            const messageDiv = document.getElementById('buyMessage');
            
            buyBtn.innerHTML = '<span class="loading"></span> Comprando...';
            buyBtn.disabled = true;
            
            try {
                const response = await fetch('/api/buy-ticket', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        number: selectedNumber,
                        userId: userSession.id,
                        username: userSession.username
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    messageDiv.innerHTML = '<div class="success-message">‚úÖ ¬°Ticket comprado exitosamente!</div>';
                    
                    // Actualizar informaci√≥n del usuario
                    setTimeout(() => {
                        closeBuyModal();
                        loadLotteryInfo();
                        loadUserInfo(); // Recargar datos del usuario
                    }, 2000);
                } else {
                    messageDiv.innerHTML = `<div class="error-message">‚ùå Error: ${result.error}</div>`;
                }
            } catch (error) {
                messageDiv.innerHTML = '<div class="error-message">‚ùå Error de conexi√≥n</div>';
            }
            
            buyBtn.innerHTML = 'Comprar Ticket (10 KOKI)';
            buyBtn.disabled = false;
        }

        // Mostrar estado
        async function showStatus() {
            const modal = document.getElementById('statusModal');
            const content = document.getElementById('statusContent');
            
            content.innerHTML = '<div style="text-align: center; padding: 40px;"><div class="loading"></div><div style="margin-top: 16px; color: rgba(255, 255, 255, 0.7);">Cargando estado...</div></div>';
            modal.style.display = 'block';
            
            try {
                const response = await fetch('/api/lottery-status');
                const data = await response.json();
                
                content.innerHTML = `
                    <div style="display: grid; gap: 20px;">
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">üé´ Tickets Vendidos</span>
                                <span style="font-size: 20px; font-weight: 700; color: #4ecdc4;">${data.ticketsSold || '0'}</span>
                            </div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">üí∞ Premio Total</span>
                                <span style="font-size: 20px; font-weight: 700; color: #ff6b6b;">${data.totalPrize || '0'} KOKI</span>
                            </div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">‚è∞ Tiempo Restante</span>
                                <span style="font-size: 20px; font-weight: 700; color: #4ecdc4;">${formatTime(data.timeRemaining || 0)}</span>
                            </div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">üìä Estado</span>
                                <span style="font-size: 20px; font-weight: 700; color: ${data.isActive ? '#4ecdc4' : '#ff6b6b'};">${data.isActive ? 'Activa' : 'Cerrada'}</span>
                            </div>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = '<div class="error-message">‚ùå Error al cargar el estado</div>';
            }
        }

        // Cerrar modal de estado
        function closeStatusModal() {
            document.getElementById('statusModal').style.display = 'none';
        }

        // Mostrar resultados
        async function showResults() {
            const modal = document.getElementById('resultsModal');
            const content = document.getElementById('resultsContent');
            
            content.innerHTML = '<div style="text-align: center; padding: 40px;"><div class="loading"></div><div style="margin-top: 16px; color: rgba(255, 255, 255, 0.7);">Cargando resultados...</div></div>';
            modal.style.display = 'block';
            
            try {
                const response = await fetch('/api/lottery-results');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    let resultsHtml = '<h3 style="font-size: 20px; font-weight: 700; margin-bottom: 24px; color: #4ecdc4; text-align: center;">üèÜ √öltimos Resultados</h3>';
                    
                    data.results.forEach((result, index) => {
                        resultsHtml += `
                            <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 20px; margin-bottom: 16px;">
                                <h4 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #ff6b6b;">Loter√≠a #${result.id}</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">üéØ N√∫meros Ganadores:</span>
                                        <span style="font-size: 16px; font-weight: 700; color: #4ecdc4;">${result.winningNumbers.join(', ')}</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-weight: 600; color: rgba(255, 255, 255, 0.8);">üë• Ganadores:</span>
                                        <span style="font-size: 16px; font-weight: 700; color: #ff6b6b;">${result.winners.length}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    content.innerHTML = resultsHtml;
                } else {
                    content.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <div style="font-size: 48px; margin-bottom: 16px;">üèÜ</div>
                            <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 12px; color: #4ecdc4;">No hay resultados a√∫n</h3>
                            <p style="color: rgba(255, 255, 255, 0.7);">Los primeros resultados aparecer√°n despu√©s del primer sorteo.</p>
                        </div>
                    `;
                }
            } catch (error) {
                content.innerHTML = '<div class="error-message">‚ùå Error al cargar los resultados</div>';
            }
        }

        // Cerrar modal de resultados
        function closeResultsModal() {
            document.getElementById('resultsModal').style.display = 'none';
        }

        // Mostrar informaci√≥n
        function showInfo() {
            document.getElementById('infoModal').style.display = 'block';
        }

        // Cerrar modal de informaci√≥n
        function closeInfoModal() {
            document.getElementById('infoModal').style.display = 'none';
        }

        // Iniciar countdown
        function startCountdown() {
            updateCountdown();
            countdownInterval = setInterval(updateCountdown, 1000);
        }

        // Actualizar countdown
        function updateCountdown() {
            // Calcular pr√≥ximo lunes a las 00:00
            const now = new Date();
            const nextMonday = getNextMonday();
            const timeDiff = nextMonday - now;
            
            if (timeDiff > 0) {
                const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            } else {
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
            }
        }

        // Obtener pr√≥ximo lunes
        function getNextMonday() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const daysUntilMonday = dayOfWeek === 0 ? 1 : 8 - dayOfWeek; // Si es domingo, lunes es ma√±ana
            const nextMonday = new Date(now);
            nextMonday.setDate(now.getDate() + daysUntilMonday);
            nextMonday.setHours(0, 0, 0, 0);
            return nextMonday;
        }

        // Cargar informaci√≥n de la loter√≠a
        async function loadLotteryInfo() {
            try {
                const response = await fetch('/api/lottery-status');
                const data = await response.json();
                
                document.getElementById('ticketsSold').textContent = data.ticketsSold || '0';
                document.getElementById('totalPrize').textContent = `${data.totalPrize || '0'} KOKI`;
            } catch (error) {
                console.error('Error loading lottery info:', error);
            }
        }

        // Formatear tiempo
        function formatTime(seconds) {
            const days = Math.floor(seconds / (24 * 60 * 60));
            const hours = Math.floor((seconds % (24 * 60 * 60)) / (60 * 60));
            const minutes = Math.floor((seconds % (60 * 60)) / 60);
            
            return `${days}d ${hours}h ${minutes}m`;
        }

        // Cerrar modales al hacer clic fuera
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
